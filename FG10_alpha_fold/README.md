# FG10: Alpha Fold features

## Introduction
This repository contains scripts for extracting key structural information from alpha-fold protein models. The extracted data includes atomic site properties and structural conformation features.
The script extracts the following features for a given protein position:
*  [**X Atom-Site Coordinate**](https://mmcif.wwpdb.org/dictionaries/mmcif_pdbx_v40.dic/Items/_atom_site.Cartn_x.html)
*  [**Y Atom-Site Coordinate**](https://mmcif.wwpdb.org/dictionaries/mmcif_pdbx_v40.dic/Items/_atom_site.Cartn_y.html)
*  [**Z Atom-Site Coordinate**](https://mmcif.wwpdb.org/dictionaries/mmcif_pdbx_v40.dic/Items/_atom_site.Cartn_z.html)
*  [**Atom Site Occupancy**](https://mmcif.wwpdb.org/dictionaries/mmcif_rcsb_nmr.dic/Items/_atom_site.occupancy.html)
*  [**Isotropic Temperature Factor Parameter**](https://mmcif.wwpdb.org/dictionaries/mmcif_rcsb_nmr.dic/Items/_atom_site.B_iso_or_equiv.html)
*  [**Structural Conformation Type ID**](https://mmcif.wwpdb.org/dictionaries/mmcif_pdbx_v50.dic/Items/_struct_conf.conf_type_id.html)

## Installation and Dependencies
Please configure the required packages for this module in the top-level directory **/DrivR-Base**. Importantly, make sure that the anaconda environment is loaded properly.

## Prerequisites
To extract information from the CIF alpha fold file, you need details about the protein variants position and impact. This information is derived from the '**_variant_effect_output_all.txt**' results, generated by the '**FG2_vep/query_vep.sh script**'. However, if you wish to use this as a stand-alone module then the input file should follow the format below:

| chrom |   pos  | ref_allele | alt_allele |  R  | driver_stat |    gene    | protein_position |
| ----- | ------ | ---------- | ---------- | --- | ----------- | ---------- | ---------------- |
| chr1  | 935778 |     C      |      T     |  1  |      1      |   SAMD11   |        28        |


## Usage

### `get_alpha_fold.py`
Using the VEP query output, we identify genes and protein positions affected by coding variants. Gene names are converted to UniProtKB IDs, and an API retrieves corresponding crystallographic information files (CIF; $.cif$) from AlphaFold based on the UniProtKB ID. We extract structural information, including X, Y, and Z atom coordinates, isotropic atomic displacement parameters (IADP), and structural conformation types. The output includes two data frames: one with the first four features (X, Y, Z coordinates, and IADP) for each variant and another with one-hot-encoded structural conformation types indicating potential effects on amino acids, such as bends or helical structures.

### Script execution
To execute the script, navigate to the /FG10_alpha_fold directory and run:

```bash
python get_alpha_fold.py $variantDir $variantFileName $outputDir
```

* $variantDir: Location of the variant file (ends with /).
* $variantFileName: Name of the variant file.
* $outputDir: Location to store the resulting file (ends with /).

## Conclusion
These scripts facilitate the extraction of crucial atomic and structural information from alpha fold protein models, aiding in the analysis of protein variants' effects.
